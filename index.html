<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Customizable Graphs</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
  <style>
    body {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      gap: 20px;
      height: 100vh;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
    }
    .plot {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="surfacePlot" class="plot"></div>
  <div id="vectorField" class="plot"></div>
  <div id="function2D" class="plot"></div>

  <script>
    //-------------------------------
    // FUNCTIONS (edit these easily)
    //-------------------------------

    // Multivariable function f(x,y)
    const f = math.parse("sin(sqrt(x^2 + y^2))").compile();

    // Vector field (u,v)
    const uExpr = math.parse("-y").compile();  // dx component
    const vExpr = math.parse("x").compile();   // dy component

    // 2D function g(x)
    const g = math.parse("cos(x)").compile();

    //-------------------------------
    // 1. 3D Surface Plot
    //-------------------------------
    let xValues = math.range(-5, 5.5, 0.5).toArray();
    let yValues = math.range(-5, 5.5, 0.5).toArray();
    let zValues = [];

    for (let i = 0; i < xValues.length; i++) {
      let row = [];
      for (let j = 0; j < yValues.length; j++) {
        row.push(f.evaluate({x: xValues[i], y: yValues[j]}));
      }
      zValues.push(row);
    }

    Plotly.newPlot("surfacePlot", [{
      type: "surface",
      x: xValues,
      y: yValues,
      z: zValues,
      colorscale: "Viridis"
    }], {title: "3D Surface f(x,y)"});


    //-------------------------------
    // 2. Vector Field
    //-------------------------------
    let X = [], Y = [], U = [], V = [];

    for (let i = -5; i <= 5; i++) {
      for (let j = -5; j <= 5; j++) {
        X.push(i);
        Y.push(j);
        U.push(uExpr.evaluate({x: i, y: j}));
        V.push(vExpr.evaluate({x: i, y: j}));
      }
    }

    let arrows = {
      type: "scatter",
      mode: "lines+markers",
      x: [],
      y: [],
      line: {width: 2, color: "blue"},
      marker: {size: 2}
    };

    for (let k = 0; k < X.length; k++) {
      arrows.x.push(X[k], X[k] + U[k], null);
      arrows.y.push(Y[k], Y[k] + V[k], null);
    }

    Plotly.newPlot("vectorField", [arrows], {
      title: "Vector Field (u,v)",
      xaxis: {scaleanchor: "y"},
      yaxis: {scaleanchor: "x"}
    });


    //-------------------------------
    // 3. 2D Function Plot
    //-------------------------------
    let xLine = math.range(-10, 10, 0.1).toArray();
    let yLine = xLine.map(x => g.evaluate({x}));

    Plotly.newPlot("function2D", [{
      type: "scatter",
      mode: "lines",
      x: xLine,
      y: yLine,
      line: {color: "red"}
    }], {title: "2D Function g(x)"});

  </script>
</body>
</html>
